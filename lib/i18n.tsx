"use client"

import React, { createContext, useContext, useEffect, useState } from "react"
import { getUserProfile } from "./userStore"
import { LANGUAGES } from "./constants"

type Language = string

interface LanguageContextType {
    language: Language
    setLanguage: (lang: Language) => void
    t: (key: string, ...args: any[]) => string
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined)

// Basic dictionary for demonstration
const translations: Record<string, Record<string, string>> = {
    English: {
        "nav.dashboard": "Dashboard",
        "nav.courses": "My Courses",
        "nav.quizzes": "Quizzes",
        "nav.tutor": "AI Tutor",
        "nav.resources": "Resources",
        "nav.settings": "Settings",
        "sidebar.level": "Level {0}",
        "sidebar.apprentice": "Apprentice",
        "dashboard.welcome": "Welcome back, {0}!",
        "dashboard.learned_minutes": "You've learned for <bold>{0} minutes</bold> today. Keep it up!",
        "dashboard.start_learning": "Start your learning journey today!",
        "dashboard.quick_actions": "Quick Actions",
        "dashboard.courses": "Your Courses",
        "dashboard.no_courses": "No courses yet",
        "dashboard.no_courses_desc": "Start your learning journey by creating your first course or enrolling in a recommended one.",
        "dashboard.browse_courses": "Browse Courses",
        "dashboard.activity": "Learning Activity",
        "dashboard.no_activity": "No activity yet",
        "dashboard.no_activity_desc": "Complete your first lesson or quiz to see your learning activity here.",
        "dashboard.up_next": "Up Next",
        "dashboard.no_events": "No upcoming events",
        "dashboard.no_events_desc": "Schedule quizzes and study sessions to stay on track.",
        "dashboard.schedule_event": "Schedule Event",
        "dashboard.search_placeholder": "Search for courses, topics, or quizzes...",
        "dashboard.notifications": "Notifications",
        "dashboard.stats": "Stats",
        "stats.streak": "Daily Streak",
        "stats.days": "Days",
        "stats.level": "Current Level",
        "stats.xp": "XP Earned",
        "actions.generate_quiz": "Generate Quiz",
        "actions.generate_quiz_desc": "Create a custom test from your notes instantly.",
        "actions.explain": "Explain Concept",
        "actions.explain_desc": "Stuck? Let AI simplify complex topics for you.",
        "actions.new_note": "New Note",
        "actions.new_note_desc": "Start a fresh page for your lecture or study session.",
        "actions.review": "Review History",
        "actions.review_desc": "Look back at what you covered yesterday.",
        "create.title": "Create Study Set",
        "create.subtitle": "Create flashcards and quizzes using AI or manually.",
        "create.set_title": "Title",
        "create.set_title_placeholder": "e.g. Biology 101 - Cell Structure",
        "create.tab_ai": "Generate with AI",
        "create.tab_manual": "Create Manually",
        "create.ai_generator_title": "AI Generator",
        "create.topic_label": "Topic or Text",
        "create.topic_placeholder": "Paste your notes here, enter a topic, or describe what you want to learn...",
        "create.generating": "Generating Magic...",
        "create.generate_button": "Generate Flashcards",
        "create.preview_title": "Generated Preview",
        "create.cards_count": "cards",
        "create.save_button": "Save & Create Quiz",
        "create.term_label": "Term",
        "create.definition_label": "Definition",
        "create.term_placeholder": "Enter term",
        "create.definition_placeholder": "Enter definition",
        "create.add_card": "Add Card",
        "create.error_title": "Please enter a title for your study set",
        "create.error_terms": "Please add at least one term or generate cards",
        "create.save_create": "Save & Create",
        "profile.title": "Profile",
        "profile.preferences": "Preferences",
        "profile.language": "Language",
        "profile.theme": "Dark Mode",
        "profile.notifications": "Email Notifications",
        "profile.delete": "Delete Account",
        "profile.overview": "Overview",
        "profile.history": "History",
        "profile.bookmarks": "Bookmarks",
        "profile.subscription": "Subscription",
        "tutor.welcome": "Hello! I'm your AI Tutor.",
        "tutor.description": "I can help you with questions, explain complex topics, or just chat about what you're learning.",
        "tutor.input_placeholder": "Ask your question...",
        "tutor.voice_mode": "Voice Mode",
        "tutor.listening": "Listening...",
        "tutor.processing": "Processing...",
        "tutor.stop": "Stop",
        "tutor.send": "Send",
        "tutor.clear_chat": "Clear Chat",
        "tutor.disclaimer": "AI can make mistakes. Verify important information.",
        "quiz.title": "AI Quiz Generator",
        "quiz.subtitle": "Create a personalized quiz in seconds from any topic.",
        "quiz.topic_label": "Topic or Subject",
        "quiz.topic_placeholder": "e.g., Quantum Physics, World War II...",
        "quiz.custom_content": "Add your own source material (optional)",
        "quiz.difficulty": "Difficulty Level",
        "quiz.question_type": "Question Type",
        "quiz.question_count": "Number of Questions",
        "quiz.language": "Language",
        "quiz.ai_mode": "AI Mode",
        "quiz.instant_feedback": "Instant Feedback",
        "quiz.generate_button": "Generate Quiz",
        "quiz.generating": "Generating...",
        "common.loading": "Loading...",
        "common.view_all": "View all",
        "common.progress": "Progress",
        "common.this_week": "This Week",
        "common.this_month": "This Month",
        "common.start_learning": "Start Learning",
        "landing.hero_title": "Learn Anything,",
        "landing.hero_subtitle": "Powered by AI",
        "landing.hero_desc": "Unlock your potential with personalized learning paths, instant feedback, and quizzes generated just for you. Master any subject 10x faster.",
        "landing.get_started": "Get Started for Free",
        "landing.view_demo": "View Demo",
        "landing.ai_assistant_message": "I've analyzed your recent quiz on Quantum Physics. You're strong on \"Wave functions\" but could use a refresher on \"Entanglement\". Shall we start a mini-lesson?",
        "landing.trusted_by": "Trusted by learners from top institutions",
        "landing.features_title": "Supercharge Your Learning",
        "landing.features_desc": "Experience the future of education with our cutting-edge AI tools designed to help you master any subject faster and retain more.",
        "landing.feature_1_title": "AI Quiz Maker",
        "landing.feature_1_desc": "Turn any text, article, PDF, or YouTube video into a comprehensive quiz in seconds. Test your knowledge instantly.",
        "landing.feature_2_title": "Smart Explanations",
        "landing.feature_2_desc": "Stuck on a difficult concept? Get instant, simplified breakdowns, analogies, and examples tailored to your level.",
        "landing.feature_3_title": "Adaptive Learning",
        "landing.feature_3_desc": "A dynamic curriculum that evolves in real-time. The AI identifies your weak spots and adjusts future lessons automatically.",
        "landing.community_title": "Learning is better together.",
        "landing.community_desc": "Share your AI-generated quizzes with friends, challenge them to beat your score, and learn collaboratively.",
        "landing.community_button": "Explore Community Features",
        "landing.cta_title": "Ready to start your journey?",
        "landing.cta_desc": "Join thousands of learners mastering new skills every day with Lumina AI. No credit card required to start.",
        "landing.view_pricing": "View Pricing",
        "landing.trial_text": "Free 14-day trial on Pro plans. Cancel anytime.",
        "profile.total_quizzes": "Total Quizzes",
        "profile.accuracy_score": "Accuracy Score",
        "profile.hours_studied": "Hours Studied",
        "profile.daily_streak_full": "Daily streak: {0} days",
        "profile.continue_learning": "Continue Learning",
        "profile.view_all": "View All",
        "profile.nothing_to_continue": "Nothing to continue",
        "profile.nothing_to_continue_desc": "Start a quiz or course to track your progress here.",
        "profile.generate_quiz_action": "Generate Quiz",
        "profile.coming_soon": "Coming Soon",
        "profile.coming_soon_desc": "This section is currently under development.",
        "profile.go_back": "Go Back",
        "profile.notifications_title": "Notifications",
        "profile.mark_all_read": "Mark all read",
        "profile.welcome_message": "Welcome to StudyFlow!",
        "profile.welcome_desc": "Get started by creating your first quiz.",
        "profile.just_now": "Just now",
        "profile.manage_subscription": "Manage Subscription",
        "profile.share_profile": "Share Profile",
        "quizzes.title": "My Quizzes",
        "quizzes.new_quiz": "New Quiz",
        "quizzes.no_quizzes": "No quizzes yet",
        "quizzes.no_quizzes_desc": "Generate your first AI-powered quiz to start learning.",
        "quizzes.delete_confirm": "Are you sure you want to delete this quiz?",
        "quizzes.questions_count": "{0} questions",
        "quizzes.retake": "Retake",
        "quizzes.start_quiz": "Start",
        "common.delete_confirm": "Are you sure? This action cannot be undone.",
        "common.retake": "Retake",
        "common.start": "Start",
        "common.create": "Create",
    },
    Spanish: {
        "nav.dashboard": "Panel de Control",
        "nav.courses": "Mis Cursos",
        "nav.quizzes": "Cuestionarios",
        "nav.tutor": "Tutor IA",
        "nav.resources": "Recursos",
        "nav.settings": "Ajustes",
        "sidebar.level": "Nivel {0}",
        "sidebar.apprentice": "Aprendiz",
        "dashboard.welcome": "¡Bienvenido de nuevo, {0}!",
        "dashboard.learned_minutes": "Has aprendido durante <bold>{0} minutos</bold> hoy. ¡Sigue así!",
        "dashboard.start_learning": "¡Comienza tu viaje de aprendizaje hoy!",
        "dashboard.quick_actions": "Acciones Rápidas",
        "dashboard.courses": "Tus Cursos",
        "dashboard.no_courses": "Aún no hay cursos",
        "dashboard.no_courses_desc": "Comienza tu aprendizaje creando tu primer curso o inscribiéndote en uno recomendado.",
        "dashboard.browse_courses": "Explorar Cursos",
        "dashboard.activity": "Actividad de Aprendizaje",
        "dashboard.no_activity": "Aún no hay actividad",
        "dashboard.no_activity_desc": "Completa tu primera lección o cuestionario para ver tu actividad aquí.",
        "dashboard.up_next": "A Continuación",
        "dashboard.no_events": "No hay eventos próximos",
        "dashboard.no_events_desc": "Programa cuestionarios y sesiones de estudio para mantenerte al día.",
        "dashboard.schedule_event": "Programar Evento",
        "stats.streak": "Racha Diaria",
        "stats.days": "Días",
        "stats.level": "Nivel Actual",
        "stats.xp": "XP Ganado",
        "actions.generate_quiz": "Generar Cuestionario",
        "actions.generate_quiz_desc": "Crea una prueba personalizada de tus notas al instante.",
        "actions.explain": "Explicar Concepto",
        "actions.explain_desc": "¿Atascado? Deja que la IA simplifique temas complejos por ti.",
        "actions.new_note": "Nueva Nota",
        "actions.new_note_desc": "Inicia una página nueva para tu lectura o sesión de estudio.",
        "actions.review": "Revisar Historial",
        "actions.review_desc": "Repasa lo que cubriste ayer.",
        "create.title": "Crear Set de Estudio",
        "create.subtitle": "Crea tarjetas y cuestionarios usando IA o manualmente.",
        "create.set_title": "Título",
        "create.set_title_placeholder": "ej. Biología 101 - Estructura Celular",
        "create.tab_ai": "Generar con IA",
        "create.tab_manual": "Crear Manualmente",
        "create.ai_generator_title": "Generador IA",
        "create.topic_label": "Tema o Texto",
        "create.topic_placeholder": "Pega tus notas aquí, introduce un tema o describe lo que quieres aprender...",
        "create.generating": "Generando Magia...",
        "create.generate_button": "Generar Tarjetas",
        "create.preview_title": "Vista Previa Generada",
        "create.cards_count": "tarjetas",
        "create.save_button": "Guardar y Crear Cuestionario",
        "create.term_label": "Término",
        "create.definition_label": "Definición",
        "create.term_placeholder": "Introduce término",
        "create.definition_placeholder": "Introduce definición",
        "create.add_card": "Añadir Tarjeta",
        "create.error_title": "Por favor, introduce un título para tu set de estudio",
        "create.error_terms": "Por favor, añade al menos un término o genera tarjetas",
        "create.save_create": "Guardar y Crear",
        "dashboard.search_placeholder": "Buscar cursos, temas o cuestionarios...",
        "dashboard.notifications": "Notificaciones",
        "dashboard.stats": "Estadísticas",
        "profile.title": "Perfil",
        "profile.preferences": "Preferencias",
        "profile.language": "Idioma",
        "profile.theme": "Modo Oscuro",
        "profile.notifications": "Notificaciones por Correo",
        "profile.delete": "Eliminar Cuenta",
        "profile.overview": "Resumen",
        "profile.history": "Historial",
        "profile.bookmarks": "Marcadores",
        "profile.subscription": "Suscripción",
        "tutor.welcome": "¡Hola! Soy tu Tutor de IA.",
        "tutor.description": "Puedo ayudarte con preguntas, explicar temas complejos o simplemente charlar sobre lo que estás aprendiendo.",
        "tutor.input_placeholder": "Haz tu pregunta...",
        "tutor.voice_mode": "Modo Voz",
        "tutor.listening": "Escuchando...",
        "tutor.processing": "Procesando...",
        "tutor.stop": "Detener",
        "tutor.send": "Enviar",
        "tutor.clear_chat": "Borrar Chat",
        "tutor.disclaimer": "La IA puede cometer errores. Verifica la información importante.",
        "quiz.title": "Generador de Cuestionarios IA",
        "quiz.subtitle": "Crea un cuestionario personalizado en segundos sobre cualquier tema.",
        "quiz.topic_label": "Tema o Asunto",
        "quiz.topic_placeholder": "ej., Física Cuántica, Segunda Guerra Mundial...",
        "quiz.custom_content": "Añade tu propio material fuente (opcional)",
        "quiz.difficulty": "Nivel de Dificultad",
        "quiz.question_type": "Tipo de Pregunta",
        "quiz.question_count": "Número de Preguntas",
        "quiz.language": "Idioma",
        "quiz.ai_mode": "Modo IA",
        "quiz.instant_feedback": "Retroalimentación Instantánea",
        "quiz.generate_button": "Generar Cuestionario",
        "quiz.generating": "Generando...",
        "common.loading": "Cargando...",
        "common.view_all": "Ver todo",
        "common.progress": "Progreso",
        "common.this_week": "Esta Semana",
        "common.this_month": "Este Mes",
        "common.start_learning": "Comenzar a Aprender",
        "landing.hero_title": "Aprende Cualquier Cosa,",
        "landing.hero_subtitle": "Potenciado por IA",
        "landing.hero_desc": "Desbloquea tu potencial con rutas de aprendizaje personalizadas, retroalimentación instantánea y cuestionarios generados solo para ti.",
        "landing.get_started": "Empieza Gratis",
        "landing.view_demo": "Ver Demo",
        "landing.ai_assistant_message": "He analizado tu cuestionario reciente sobre Física Cuántica. Eres fuerte en \"Funciones de onda\" pero podrías necesitar un repaso en \"Entrelazamiento\". ¿Empezamos una mini-lección?",
        "landing.trusted_by": "Con la confianza de estudiantes de las mejores instituciones",
        "landing.features_title": "Supercarga tu Aprendizaje",
        "landing.features_desc": "Experimenta el futuro de la educación con nuestras herramientas de IA de vanguardia.",
        "landing.feature_1_title": "Creador de Quiz IA",
        "landing.feature_1_desc": "Convierte cualquier texto, artículo o video en un cuestionario completo en segundos.",
        "landing.feature_2_title": "Explicaciones Inteligentes",
        "landing.feature_2_desc": "¿Atascado? Obtén desgloses instantáneos y simplificados adaptados a tu nivel.",
        "landing.feature_3_title": "Aprendizaje Adaptativo",
        "landing.feature_3_desc": "Un currículo dinámico que evoluciona en tiempo real. La IA identifica tus puntos débiles.",
        "landing.community_title": "Aprender es mejor juntos.",
        "landing.community_desc": "Comparte tus cuestionarios generados por IA con amigos y desafíalos.",
        "landing.community_button": "Explorar Comunidad",
        "landing.cta_title": "¿Listo para empezar tu viaje?",
        "landing.cta_desc": "Únete a miles de estudiantes que dominan nuevas habilidades cada día.",
        "landing.view_pricing": "Ver Precios",
        "landing.trial_text": "Prueba gratuita de 14 días. Cancela cuando quieras.",
        "profile.total_quizzes": "Total de Cuestionarios",
        "profile.accuracy_score": "Puntuación de Precisión",
        "profile.hours_studied": "Horas Estudiadas",
        "profile.daily_streak_full": "Racha diaria: {0} días",
        "profile.continue_learning": "Continuar Aprendiendo",
        "profile.view_all": "Ver Todo",
        "profile.nothing_to_continue": "Nada que continuar",
        "profile.nothing_to_continue_desc": "Comienza un cuestionario o curso para seguir tu progreso aquí.",
        "profile.generate_quiz_action": "Generar Cuestionario",
        "profile.coming_soon": "Próximamente",
        "profile.coming_soon_desc": "Esta sección está actualmente en desarrollo.",
        "profile.go_back": "Volver",
        "profile.notifications_title": "Notificaciones",
        "profile.mark_all_read": "Marcar todo como leído",
        "profile.welcome_message": "¡Bienvenido a StudyFlow!",
        "profile.welcome_desc": "Comienza creando tu primer cuestionario.",
        "profile.just_now": "Justo ahora",
        "profile.manage_subscription": "Gestionar Suscripción",
        "profile.share_profile": "Compartir Perfil",
        "quizzes.title": "Mis Cuestionarios",
        "quizzes.new_quiz": "Nuevo Cuestionario",
        "quizzes.no_quizzes": "Aún no hay cuestionarios",
        "quizzes.no_quizzes_desc": "Genera tu primer cuestionario con IA para empezar a aprender.",
        "quizzes.delete_confirm": "¿Estás seguro de que quieres eliminar este cuestionario?",
        "quizzes.questions_count": "{0} preguntas",
        "quizzes.retake": "Reintentar",
        "quizzes.start_quiz": "Comenzar",
        "common.delete_confirm": "¿Estás seguro? Esta acción no se puede deshacer.",
        "common.retake": "Reintentar",
        "common.start": "Comenzar",
        "common.create": "Crear",
    },
    French: {
        "nav.dashboard": "Tableau de Bord",
        "nav.courses": "Mes Cours",
        "nav.quizzes": "Quiz",
        "nav.tutor": "Tuteur IA",
        "nav.resources": "Ressources",
        "nav.settings": "Paramètres",
        "sidebar.level": "Niveau {0}",
        "sidebar.apprentice": "Apprenti",
        "dashboard.welcome": "Bon retour, {0} !",
        "dashboard.learned_minutes": "Vous avez appris pendant <bold>{0} minutes</bold> aujourd'hui. Continuez comme ça !",
        "dashboard.start_learning": "Commencez votre apprentissage aujourd'hui !",
        "dashboard.quick_actions": "Actions Rapides",
        "dashboard.courses": "Vos Cours",
        "dashboard.no_courses": "Pas encore de cours",
        "dashboard.no_courses_desc": "Commencez votre apprentissage en créant votre premier cours ou en vous inscrivant à un cours recommandé.",
        "dashboard.browse_courses": "Parcourir les Cours",
        "dashboard.activity": "Activité d'Apprentissage",
        "dashboard.no_activity": "Pas encore d'activité",
        "dashboard.no_activity_desc": "Terminez votre première leçon ou quiz pour voir votre activité ici.",
        "dashboard.up_next": "À Suivre",
        "dashboard.no_events": "Aucun événement à venir",
        "dashboard.no_events_desc": "Planifiez des quiz et des sessions d'étude pour rester sur la bonne voie.",
        "dashboard.schedule_event": "Planifier un Événement",
        "stats.streak": "Série Quotidienne",
        "stats.days": "Jours",
        "stats.level": "Niveau Actuel",
        "stats.xp": "XP Gagnés",
        "actions.generate_quiz": "Générer un Quiz",
        "actions.generate_quiz_desc": "Créez un test personnalisé à partir de vos notes instantanément.",
        "actions.explain": "Expliquer un Concept",
        "actions.explain_desc": "Bloqué ? Laissez l'IA simplifier les sujets complexes pour vous.",
        "actions.new_note": "Nouvelle Note",
        "actions.new_note_desc": "Commencez une nouvelle page pour votre cours ou session d'étude.",
        "actions.review": "Revoir l'Historique",
        "actions.review_desc": "Revenez sur ce que vous avez couvert hier.",
        "create.title": "Créer un Set d'Étude",
        "create.subtitle": "Créez des cartes mémoire et des quiz en utilisant l'IA ou manuellement.",
        "create.set_title": "Titre",
        "create.set_title_placeholder": "ex. Biologie 101 - Structure Cellulaire",
        "create.tab_ai": "Générer avec l'IA",
        "create.tab_manual": "Créer Manuellement",
        "create.ai_generator_title": "Générateur IA",
        "create.topic_label": "Sujet ou Texte",
        "create.topic_placeholder": "Collez vos notes ici, entrez un sujet ou décrivez ce que vous voulez apprendre...",
        "create.generating": "Génération Magique...",
        "create.generate_button": "Générer des Cartes",
        "create.preview_title": "Aperçu Généré",
        "create.cards_count": "cartes",
        "create.save_button": "Enregistrer & Créer Quiz",
        "create.term_label": "Terme",
        "create.definition_label": "Définition",
        "create.term_placeholder": "Entrer le terme",
        "create.definition_placeholder": "Entrer la définition",
        "create.add_card": "Ajouter une Carte",
        "create.error_title": "Veuillez entrer un titre pour votre set d'étude",
        "create.error_terms": "Veuillez ajouter au moins un terme ou générer des cartes",
        "create.save_create": "Enregistrer & Créer",
        "dashboard.search_placeholder": "Rechercher des cours, sujets ou quiz...",
        "dashboard.notifications": "Notifications",
        "dashboard.stats": "Statistiques",
        "profile.title": "Profil",
        "profile.preferences": "Préférences",
        "profile.language": "Langue",
        "profile.theme": "Mode Sombre",
        "profile.notifications": "Notifications par E-mail",
        "profile.delete": "Supprimer le Compte",
        "profile.overview": "Aperçu",
        "profile.history": "Historique",
        "profile.bookmarks": "Favoris",
        "profile.subscription": "Abonnement",
        "tutor.welcome": "Bonjour ! Je suis votre Tuteur IA.",
        "tutor.description": "Je peux vous aider avec des questions, expliquer des sujets complexes ou simplement discuter de ce que vous apprenez.",
        "tutor.input_placeholder": "Posez votre question...",
        "tutor.voice_mode": "Mode Vocal",
        "tutor.listening": "Écoute...",
        "tutor.processing": "Traitement...",
        "tutor.stop": "Arrêter",
        "tutor.send": "Envoyer",
        "tutor.clear_chat": "Effacer le chat",
        "tutor.disclaimer": "L'IA peut faire des erreurs. Vérifiez les informations importantes.",
        "quiz.title": "Générateur de Quiz IA",
        "quiz.subtitle": "Créez un quiz personnalisé en quelques secondes sur n'importe quel sujet.",
        "quiz.topic_label": "Sujet ou Thème",
        "quiz.topic_placeholder": "ex., Physique Quantique, Seconde Guerre Mondiale...",
        "quiz.custom_content": "Ajoutez votre propre matériel source (optionnel)",
        "quiz.difficulty": "Niveau de Difficulté",
        "quiz.question_type": "Type de Question",
        "quiz.question_count": "Nombre de Questions",
        "quiz.language": "Langue",
        "quiz.ai_mode": "Mode IA",
        "quiz.instant_feedback": "Retour Instantané",
        "quiz.generate_button": "Générer le Quiz",
        "quiz.generating": "Génération...",
        "common.loading": "Chargement...",
        "common.view_all": "Voir tout",
        "common.progress": "Progrès",
        "common.this_week": "Cette Semaine",
        "common.this_month": "Ce Mois",
        "common.start_learning": "Commencer l'Apprentissage",
        "landing.hero_title": "Apprenez Tout,",
        "landing.hero_subtitle": "Propulsé par l'IA",
        "landing.hero_desc": "Libérez votre potentiel avec des parcours d'apprentissage personnalisés, un retour instantané et des quiz générés pour vous.",
        "landing.get_started": "Commencer Gratuitement",
        "landing.view_demo": "Voir la Démo",
        "landing.ai_assistant_message": "J'ai analysé votre quiz récent. Vous maîtrisez les \"Fonctions d'onde\" mais pourriez revoir l'\"Intrication\". On commence ?",
        "landing.trusted_by": "Approuvé par les apprenants des meilleures institutions",
        "landing.features_title": "Boostez Votre Apprentissage",
        "landing.features_desc": "Découvrez l'avenir de l'éducation avec nos outils d'IA de pointe.",
        "landing.feature_1_title": "Créateur de Quiz IA",
        "landing.feature_1_desc": "Transformez n'importe quel texte ou vidéo en un quiz complet en quelques secondes.",
        "landing.feature_2_title": "Explications Intelligentes",
        "landing.feature_2_desc": "Bloqué ? Obtenez des explications simplifiées et adaptées à votre niveau.",
        "landing.feature_3_title": "Apprentissage Adaptatif",
        "landing.feature_3_desc": "Un programme dynamique qui évolue en temps réel selon vos besoins.",
        "landing.community_title": "Apprendre est mieux ensemble.",
        "landing.community_desc": "Partagez vos quiz, défiez vos amis et apprenez collaborativement.",
        "landing.community_button": "Explorer la Communauté",
        "landing.cta_title": "Prêt à commencer ?",
        "landing.cta_desc": "Rejoignez des milliers d'apprenants qui maîtrisent de nouvelles compétences chaque jour.",
        "landing.view_pricing": "Voir les Prix",
        "landing.trial_text": "Essai gratuit de 14 jours. Annulez à tout moment.",
        "profile.total_quizzes": "Total des Quiz",
        "profile.accuracy_score": "Score de Précision",
        "profile.hours_studied": "Heures Étudiées",
        "profile.daily_streak_full": "Série quotidienne : {0} jours",
        "profile.continue_learning": "Continuer l'Apprentissage",
        "profile.view_all": "Voir Tout",
        "profile.nothing_to_continue": "Rien à continuer",
        "profile.nothing_to_continue_desc": "Commencez un quiz ou un cours pour suivre votre progression ici.",
        "profile.generate_quiz_action": "Générer un Quiz",
        "profile.coming_soon": "Bientôt Disponible",
        "profile.coming_soon_desc": "Cette section est actuellement en développement.",
        "profile.go_back": "Retourner",
        "profile.notifications_title": "Notifications",
        "profile.mark_all_read": "Tout marquer comme lu",
        "profile.welcome_message": "Bienvenue sur StudyFlow !",
        "profile.welcome_desc": "Commencez par créer votre premier quiz.",
        "profile.just_now": "À l'instant",
        "profile.manage_subscription": "Gérer l'Abonnement",
        "profile.share_profile": "Partager le Profil",
        "quizzes.title": "Mes Quiz",
        "quizzes.new_quiz": "Nouveau Quiz",
        "quizzes.no_quizzes": "Pas encore de quiz",
        "quizzes.no_quizzes_desc": "Générez votre premier quiz IA pour commencer à apprendre.",
        "quizzes.delete_confirm": "Êtes-vous sûr de vouloir supprimer ce quiz ?",
        "quizzes.questions_count": "{0} questions",
        "quizzes.retake": "Recommencer",
        "quizzes.start_quiz": "Démarrer",
        "common.delete_confirm": "Êtes-vous sûr ? Cette action est irréversible.",
        "common.retake": "Recommencer",
        "common.start": "Démarrer",
        "common.create": "Créer",
    },
    German: {
        "nav.dashboard": "Übersicht",
        "nav.courses": "Meine Kurse",
        "nav.quizzes": "Quizze",
        "nav.tutor": "KI-Tutor",
        "nav.resources": "Ressourcen",
        "nav.settings": "Einstellungen",
        "sidebar.level": "Level {0}",
        "sidebar.apprentice": "Lehrling",
        "dashboard.welcome": "Willkommen zurück, {0}!",
        "dashboard.learned_minutes": "Du hast heute <bold>{0} Minuten</bold> gelernt. Weiter so!",
        "dashboard.start_learning": "Beginne deine Lernreise heute!",
        "dashboard.quick_actions": "Schnellaktionen",
        "dashboard.courses": "Deine Kurse",
        "dashboard.no_courses": "Noch keine Kurse",
        "dashboard.no_courses_desc": "Beginne deine Lernreise, indem du deinen ersten Kurs erstellst oder dich für einen empfohlenen anmeldest.",
        "dashboard.browse_courses": "Kurse durchsuchen",
        "dashboard.activity": "Lernaktivität",
        "dashboard.no_activity": "Noch keine Aktivität",
        "dashboard.no_activity_desc": "Schließe deine erste Lektion oder dein erstes Quiz ab, um deine Aktivität hier zu sehen.",
        "dashboard.up_next": "Als Nächstes",
        "dashboard.no_events": "Keine bevorstehenden Ereignisse",
        "dashboard.no_events_desc": "Plane Quizze und Lernsitzungen, um auf Kurs zu bleiben.",
        "dashboard.schedule_event": "Ereignis planen",
        "stats.streak": "Tagessträhne",
        "stats.days": "Tage",
        "stats.level": "Aktuelles Level",
        "stats.xp": "Verdiente XP",
        "actions.generate_quiz": "Quiz generieren",
        "actions.generate_quiz_desc": "Erstelle sofort einen benutzerdefinierten Test aus deinen Notizen.",
        "actions.explain": "Konzept erklären",
        "actions.explain_desc": "Du steckst fest? Lass dir von der KI komplexe Themen vereinfachen.",
        "actions.new_note": "Neue Notiz",
        "actions.new_note_desc": "Beginne eine neue Seite für deine Vorlesung oder Lernsitzung.",
        "actions.review": "Verlauf überprüfen",
        "actions.review_desc": "Schau dir an, was du gestern behandelt hast.",
        "create.title": "Lernset erstellen",
        "create.subtitle": "Erstelle Lernkarten und Quizze mit KI oder manuell.",
        "create.set_title": "Titel",
        "create.set_title_placeholder": "z.B. Biologie 101 - Zellstruktur",
        "create.tab_ai": "Mit KI generieren",
        "create.tab_manual": "Manuell erstellen",
        "create.ai_generator_title": "KI-Generator",
        "create.topic_label": "Thema oder Text",
        "create.topic_placeholder": "Füge hier deine Notizen ein, gib ein Thema ein oder beschreibe, was du lernen möchtest...",
        "create.generating": "Generiere Magie...",
        "create.generate_button": "Lernkarten generieren",
        "create.preview_title": "Generierte Vorschau",
        "create.cards_count": "Karten",
        "create.save_button": "Speichern & Quiz erstellen",
        "create.term_label": "Begriff",
        "create.definition_label": "Definition",
        "create.term_placeholder": "Begriff eingeben",
        "create.definition_placeholder": "Definition eingeben",
        "create.add_card": "Karte hinzufügen",
        "create.error_title": "Bitte gib einen Titel für dein Lernset ein",
        "create.error_terms": "Bitte füge mindestens einen Begriff hinzu oder generiere Karten",
        "create.save_create": "Speichern & Erstellen",
        "dashboard.search_placeholder": "Suche nach Kursen, Themen oder Quizzen...",
        "dashboard.notifications": "Benachrichtigungen",
        "dashboard.stats": "Statistiken",
        "profile.title": "Profil",
        "profile.preferences": "Präferenzen",
        "profile.language": "Sprache",
        "profile.theme": "Dunkelmodus",
        "profile.notifications": "E-Mail-Benachrichtigungen",
        "profile.delete": "Konto löschen",
        "profile.overview": "Überblick",
        "profile.history": "Verlauf",
        "profile.bookmarks": "Lesezeichen",
        "profile.subscription": "Abonnement",
        "tutor.welcome": "Hallo! Ich bin dein KI-Tutor.",
        "tutor.description": "Ich kann dir bei Fragen helfen, komplexe Themen erklären oder einfach über das Gelernte plaudern.",
        "tutor.input_placeholder": "Stelle deine Frage...",
        "tutor.voice_mode": "Sprachmodus",
        "tutor.listening": "Zuhören...",
        "tutor.processing": "Verarbeiten...",
        "tutor.stop": "Stopp",
        "tutor.send": "Senden",
        "tutor.clear_chat": "Chat löschen",
        "tutor.disclaimer": "KI kann Fehler machen. Überprüfe wichtige Informationen.",
        "quiz.title": "KI-Quiz-Generator",
        "quiz.subtitle": "Erstelle in Sekunden ein personalisiertes Quiz zu jedem Thema.",
        "quiz.topic_label": "Thema oder Fach",
        "quiz.topic_placeholder": "z.B. Quantenphysik, Zweiter Weltkrieg...",
        "quiz.custom_content": "Füge dein eigenes Quellmaterial hinzu (optional)",
        "quiz.difficulty": "Schwierigkeitsgrad",
        "quiz.question_type": "Fragetyp",
        "quiz.question_count": "Anzahl der Fragen",
        "quiz.language": "Sprache",
        "quiz.ai_mode": "KI-Modus",
        "quiz.instant_feedback": "Sofortiges Feedback",
        "quiz.generate_button": "Quiz generieren",
        "quiz.generating": "Generieren...",
        "common.loading": "Laden...",
        "common.view_all": "Alle ansehen",
        "common.progress": "Fortschritt",
        "common.this_week": "Diese Woche",
        "common.this_month": "Diesen Monat",
        "common.start_learning": "Lernen beginnen",
        "landing.hero_title": "Lerne Alles,",
        "landing.hero_subtitle": "Befeuert durch KI",
        "landing.hero_desc": "Entfalte dein Potenzial mit personalisierten Lernpfaden und sofortigem Feedback.",
        "landing.get_started": "Kostenlos Starten",
        "landing.view_demo": "Demo Ansehen",
        "landing.ai_assistant_message": "Ich habe dein Quiz analysiert. Du bist stark in \"Wellenfunktionen\", aber \"Verschränkung\" braucht Wiederholung.",
        "landing.trusted_by": "Vertraut von Lernenden der besten Institutionen",
        "landing.features_title": "Supercharge dein Lernen",
        "landing.features_desc": "Erlebe die Zukunft der Bildung mit unseren KI-Tools.",
        "landing.feature_1_title": "KI-Quiz-Maker",
        "landing.feature_1_desc": "Verwandle Text oder Video in Sekunden in ein Quiz.",
        "landing.feature_2_title": "Smarte Erklärungen",
        "landing.feature_2_desc": "Festhängen? Erhalte sofort vereinfachte Erklärungen.",
        "landing.feature_3_title": "Adaptives Lernen",
        "landing.feature_3_desc": "Ein dynamischer Lehrplan, der sich in Echtzeit anpasst.",
        "landing.community_title": "Lernen ist besser zusammen.",
        "landing.community_desc": "Teile deine Quizze und lerne kollaborativ.",
        "landing.community_button": "Community Entdecken",
        "landing.cta_title": "Bereit zu starten?",
        "landing.cta_desc": "Schließe dich Tausenden von Lernenden an.",
        "landing.view_pricing": "Preise Ansehen",
        "landing.trial_text": "Kostenlose 14-Tage-Testversion.",
        "profile.total_quizzes": "Gesamte Quizze",
        "profile.accuracy_score": "Genauigkeit",
        "profile.hours_studied": "Lernstunden",
        "profile.daily_streak_full": "Tagessträhne: {0} Tage",
        "profile.continue_learning": "Weiterlernen",
        "profile.view_all": "Alle ansehen",
        "profile.nothing_to_continue": "Nichts fortzusetzen",
        "profile.nothing_to_continue_desc": "Starte ein Quiz, um deinen Fortschritt hier zu sehen.",
        "profile.generate_quiz_action": "Quiz generieren",
        "profile.coming_soon": "Demnächst verfügbar",
        "profile.coming_soon_desc": "Dieser Bereich wird noch entwickelt.",
        "profile.go_back": "Zurück",
        "profile.notifications_title": "Benachrichtigungen",
        "profile.mark_all_read": "Alle als gelesen markieren",
        "profile.welcome_message": "Willkommen bei StudyFlow!",
        "profile.welcome_desc": "Beginne mit deinem ersten Quiz.",
        "profile.just_now": "Gerade eben",
        "profile.manage_subscription": "Abonnement verwalten",
        "profile.share_profile": "Profil teilen",
        "quizzes.title": "Meine Quizze",
        "quizzes.new_quiz": "Neues Quiz",
        "quizzes.no_quizzes": "Noch keine Quizze",
        "quizzes.no_quizzes_desc": "Generiere dein erstes KI-Quiz.",
        "quizzes.delete_confirm": "Möchtest du dieses Quiz wirklich löschen?",
        "quizzes.questions_count": "{0} Fragen",
        "quizzes.retake": "Wiederholen",
        "quizzes.start_quiz": "Starten",
        "common.delete_confirm": "Bist du sicher? Dies kann nicht rückgängig gemacht werden.",
        "common.retake": "Wiederholen",
        "common.start": "Starten",
        "common.create": "Erstellen",
    },
    Dutch: {
        "nav.dashboard": "Dashboard",
        "nav.courses": "Mijn Cursussen",
        "nav.quizzes": "Quizzen",
        "nav.tutor": "AI Tutor",
        "nav.resources": "Bronnen",
        "nav.settings": "Instellingen",
        "sidebar.level": "Niveau {0}",
        "sidebar.apprentice": "Leerling",
        "dashboard.welcome": "Welkom terug, {0}!",
        "dashboard.learned_minutes": "Je hebt vandaag <bold>{0} minuten</bold> geleerd. Ga zo door!",
        "dashboard.start_learning": "Begin vandaag nog met leren!",
        "dashboard.quick_actions": "Snelle Acties",
        "dashboard.courses": "Jouw Cursussen",
        "dashboard.no_courses": "Nog geen cursussen",
        "dashboard.no_courses_desc": "Begin met leren door je eerste cursus te maken of je in te schrijven voor een aanbevolen cursus.",
        "dashboard.browse_courses": "Cursussen Bekijken",
        "dashboard.activity": "Leeractiviteit",
        "dashboard.no_activity": "Nog geen activiteit",
        "dashboard.no_activity_desc": "Voltooi je eerste les of quiz om je activiteit hier te zien.",
        "dashboard.up_next": "Hierna",
        "dashboard.no_events": "Geen evenementen",
        "dashboard.no_events_desc": "Plan quizzen en studiesessies om op schema te blijven.",
        "dashboard.schedule_event": "Evenement Plannen",
        "stats.streak": "Dagelijkse Reeks",
        "stats.days": "Dagen",
        "stats.level": "Huidig Niveau",
        "stats.xp": "XP Verdiend",
        "actions.generate_quiz": "Quiz Genereren",
        "actions.generate_quiz_desc": "Maak direct een aangepaste test van je notities.",
        "actions.explain": "Concept Uitleggen",
        "actions.explain_desc": "Vastgelopen? Laat AI complexe onderwerpen voor je vereenvoudigen.",
        "actions.new_note": "Nieuwe Notitie",
        "actions.new_note_desc": "Begin een nieuwe pagina voor je college of studiesessie.",
        "actions.review": "Geschiedenis Bekijken",
        "actions.review_desc": "Kijk terug op wat je gisteren hebt behandeld.",
        "create.title": "Studieset Maken",
        "create.subtitle": "Maak flashcards en quizzen met AI of handmatig.",
        "create.set_title": "Titel",
        "create.set_title_placeholder": "bijv. Biologie 101 - Celstructuur",
        "create.tab_ai": "Genereren met AI",
        "create.tab_manual": "Handmatig Maken",
        "create.ai_generator_title": "AI Generator",
        "create.topic_label": "Onderwerp of Tekst",
        "create.topic_placeholder": "Plak hier je notities, voer een onderwerp in of beschrijf wat je wilt leren...",
        "create.generating": "Magie Genereren...",
        "create.generate_button": "Flashcards Genereren",
        "create.preview_title": "Gegenereerd Voorbeeld",
        "create.cards_count": "kaarten",
        "create.save_button": "Opslaan & Quiz Maken",
        "create.term_label": "Term",
        "create.definition_label": "Definitie",
        "create.term_placeholder": "Term invoeren",
        "create.definition_placeholder": "Definitie invoeren",
        "create.add_card": "Kaart Toevoegen",
        "create.error_title": "Voer een titel in voor je studieset",
        "create.error_terms": "Voeg ten minste één term toe of genereer kaarten",
        "create.save_create": "Opslaan & Maken",
        "dashboard.search_placeholder": "Zoek naar cursussen, onderwerpen of quizzen...",
        "dashboard.notifications": "Meldingen",
        "dashboard.stats": "Statistieken",
        "profile.title": "Profiel",
        "profile.preferences": "Voorkeuren",
        "profile.language": "Taal",
        "profile.theme": "Donkere Modus",
        "profile.notifications": "E-mailmeldingen",
        "profile.delete": "Account Verwijderen",
        "profile.overview": "Overzicht",
        "profile.history": "Geschiedenis",
        "profile.bookmarks": "Bladwijzers",
        "profile.subscription": "Abonnement",
        "tutor.welcome": "Hallo! Ik ben jouw AI-tutor.",
        "tutor.description": "Ik kan je helpen met vragen, complexe onderwerpen uitleggen of gewoon chatten over wat je leert.",
        "tutor.input_placeholder": "Stel je vraag...",
        "tutor.voice_mode": "Spraakmodus",
        "tutor.listening": "Luisteren...",
        "tutor.processing": "Verwerken...",
        "tutor.stop": "Stop",
        "tutor.send": "Verzenden",
        "tutor.clear_chat": "Chat wissen",
        "tutor.disclaimer": "AI kan fouten maken. Controleer belangrijke informatie.",
        "quiz.title": "AI Quiz Generator",
        "quiz.subtitle": "Maak binnen enkele seconden een gepersonaliseerde quiz over elk onderwerp.",
        "quiz.topic_label": "Onderwerp of Thema",
        "quiz.topic_placeholder": "bijv. Kwantumfysica, Tweede Wereldoorlog...",
        "quiz.custom_content": "Voeg je eigen bronmateriaal toe (optioneel)",
        "quiz.difficulty": "Moeilijkheidsgraad",
        "quiz.question_type": "Vraagtype",
        "quiz.question_count": "Aantal vragen",
        "quiz.language": "Taal",
        "quiz.ai_mode": "AI-modus",
        "quiz.instant_feedback": "Directe Feedback",
        "quiz.generate_button": "Quiz Genereren",
        "quiz.generating": "Genereren...",
        "common.loading": "Laden...",
        "common.view_all": "Alles bekijken",
        "common.progress": "Voortgang",
        "common.this_week": "Deze Week",
        "common.this_month": "Deze Maand",
        "common.start_learning": "Begin met Leren",
        "landing.hero_title": "Leer Alles,",
        "landing.hero_subtitle": "Aangedreven door AI",
        "landing.hero_desc": "Ontgrendel je potentieel met gepersonaliseerde leerpaden.",
        "landing.get_started": "Start Gratis",
        "landing.view_demo": "Bekijk Demo",
        "landing.ai_assistant_message": "Ik heb je quiz geanalyseerd. Je bent sterk in \"Golffuncties\". Zullen we een miniles starten?",
        "landing.trusted_by": "Vertrouwd door studenten van topinstituten",
        "landing.features_title": "Geef je Leren een Boost",
        "landing.features_desc": "Ervaar de toekomst van onderwijs met onze AI-tools.",
        "landing.feature_1_title": "AI Quiz Maker",
        "landing.feature_1_desc": "Zet elke tekst of video om in een quiz in seconden.",
        "landing.feature_2_title": "Slimme Uitleg",
        "landing.feature_2_desc": "Vastgelopen? Krijg direct vereenvoudigde uitleg.",
        "landing.feature_3_title": "Adaptief Leren",
        "landing.feature_3_desc": "Een dynamisch curriculum dat in realtime evolueert.",
        "landing.community_title": "Leren is leuker samen.",
        "landing.community_desc": "Deel je quizzen met vrienden en leer samen.",
        "landing.community_button": "Ontdek Community",
        "landing.cta_title": "Klaar om te starten?",
        "landing.cta_desc": "Sluit je aan bij duizenden studenten.",
        "landing.view_pricing": "Bekijk Prijzen",
        "landing.trial_text": "Gratis proefperiode van 14 dagen.",
        "profile.total_quizzes": "Totaal Quizzen",
        "profile.accuracy_score": "Nauwkeurigheid",
        "profile.hours_studied": "Uren Geleerd",
        "profile.daily_streak_full": "Dagelijkse reeks: {0} dagen",
        "profile.continue_learning": "Verder Leren",
        "profile.view_all": "Alles Bekijken",
        "profile.nothing_to_continue": "Niets te hervatten",
        "profile.nothing_to_continue_desc": "Start een quiz om je voortgang te zien.",
        "profile.generate_quiz_action": "Quiz Genereren",
        "profile.coming_soon": "Binnenkort Beschikbaar",
        "profile.coming_soon_desc": "Dit onderdeel is in ontwikkeling.",
        "profile.go_back": "Ga Terug",
        "profile.notifications_title": "Meldingen",
        "profile.mark_all_read": "Markeer als gelezen",
        "profile.welcome_message": "Welkom bij StudyFlow!",
        "profile.welcome_desc": "Begin met je eerste quiz.",
        "profile.just_now": "Zojuist",
        "profile.manage_subscription": "Abonnement Beheren",
        "profile.share_profile": "Profiel Delen",
        "quizzes.title": "Mijn Quizzen",
        "quizzes.new_quiz": "Nieuwe Quiz",
        "quizzes.no_quizzes": "Nog geen quizzen",
        "quizzes.no_quizzes_desc": "Genereer je eerste AI-quiz.",
        "quizzes.delete_confirm": "Weet je zeker dat je deze quiz wilt verwijderen?",
        "quizzes.questions_count": "{0} vragen",
        "quizzes.retake": "Opnieuw",
        "quizzes.start_quiz": "Start",
        "common.delete_confirm": "Weet je het zeker? Dit kan niet ongedaan worden gemaakt.",
        "common.retake": "Opnieuw",
        "common.start": "Start",
        "common.create": "Maken",
    },

}



// ... (translations object remains unchanged) ...

export function LanguageProvider({ children }: { children: React.ReactNode }) {
    const [language, setLanguageState] = useState<Language>("English")

    // Load from storage on mount
    useEffect(() => {
        const profile = getUserProfile()
        if (profile?.language) {
            setLanguageState(profile.language)
        }
    }, [])

    const setLanguage = (lang: Language) => {
        setLanguageState(lang)
        // Persistence is handled by the calling component (Profile page) or we could move it here
        // For now, we sync state here, and Profile page syncs to localStorage/UserProfile
    }

    const t = (key: string, ...args: any[]) => {
        const dict = translations[language] || translations["English"]
        let text = dict[key] || key

        if (args.length > 0) {
            args.forEach((arg, index) => {
                text = text.replace(new RegExp(`\\{${index}\\}`, 'g'), String(arg))
            })
        }
        return text
    }

    return (
        <LanguageContext.Provider value={{ language, setLanguage, t }}>
            {children}
        </LanguageContext.Provider>
    )
}

export function useLanguage() {
    const context = useContext(LanguageContext)
    if (context === undefined) {
        throw new Error("useLanguage must be used within a LanguageProvider")
    }
    return context
}
